{% extends "base.html" %}

{% block title %}Admin Dashboard - AAFS AI{% endblock %}

{% block extra_css %}
<style>
    .dashboard-container {
        width: 100%;
        max-width: 100%;
        overflow-x: hidden;
    }

    .content-wrapper {
        padding-top: 48px !important;
    }

    .welcome-banner {
        width: 100%;
        max-width: 100%;
        background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        border-radius: 10px;
        padding: 16px 20px;
        margin-top: 0;
        margin-bottom: 20px;
        color: white;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 12px;
    }

    .welcome-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: white;
        margin: 0 0 2px 0;
    }

    .welcome-subtitle {
        font-size: 0.8125rem;
        color: rgba(255, 255, 255, 0.85);
        margin: 0;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
    }

    .stat-card {
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 20px;
        transition: all 0.2s ease;
        cursor: pointer;
        text-decoration: none;
        display: block;
        color: inherit;
    }

    .stat-card,
    .stat-card:visited,
    .stat-card:link {
        color: inherit;
        text-decoration: none;
    }

    .stat-card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
        border-color: var(--accent);
    }

    .stat-card:active {
        transform: translateY(0);
    }

    .stat-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
    }

    .stat-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
    }

    .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--hover-bg);
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-main);
        margin: 0;
    }

    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .section-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 700;
    }

    .table-container {
        background: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        overflow: hidden;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 12px 16px;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
    }

    th {
        background: var(--sidebar-bg);
        font-weight: 600;
        font-size: 0.875rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    td {
        font-size: 0.875rem;
        color: var(--text-main);
    }

    tr:hover {
        background: var(--hover-bg);
    }

    .clickable-row {
        cursor: pointer;
    }

    .clickable-row:hover {
        background: var(--hover-bg);
    }

    .badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    .badge-success {
        background: rgba(34, 197, 94, 0.1);
        color: #22c55e;
    }

    .badge-info {
        background: rgba(59, 130, 246, 0.1);
        color: #3b82f6;
    }

    .badge-warning {
        background: rgba(234, 179, 8, 0.1);
        color: #eab308;
    }

    .btn-primary {
        background: var(--accent);
        color: var(--white);
        border: none;
        padding: 8px 16px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
    }

    .btn-primary:hover {
        background: var(--accent-hover);
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="welcome-banner">
        <div>
            <div class="welcome-title">Admin Dashboard</div>
            <div class="welcome-subtitle">Manage users, courses, and platform settings</div>
        </div>
    </div>

    <div class="stats-grid">
        <a href="/admin/users" class="stat-card">
            <div class="stat-header">
                <span class="stat-label">Total Users</span>
                <div class="stat-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                </div>
            </div>
            <p class="stat-value">{{ stats.total_users }}</p>
        </a>

        <a href="/admin/users?role=Student" class="stat-card">
            <div class="stat-header">
                <span class="stat-label">Students</span>
                <div class="stat-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 20h9"></path>
                        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                    </svg>
                </div>
            </div>
            <p class="stat-value">{{ stats.total_students }}</p>
        </a>

        <a href="/admin/users?role=Instructor" class="stat-card">
            <div class="stat-header">
                <span class="stat-label">Instructors</span>
                <div class="stat-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                </div>
            </div>
            <p class="stat-value">{{ stats.total_instructors }}</p>
        </a>

        <a href="/admin/courses" class="stat-card">
            <div class="stat-header">
                <span class="stat-label">Courses</span>
                <div class="stat-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                </div>
            </div>
            <p class="stat-value">{{ stats.total_courses }}</p>
        </a>

        <a href="/admin/enrollments" class="stat-card">
            <div class="stat-header">
                <span class="stat-label">Active Enrollments</span>
                <div class="stat-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="8.5" cy="7" r="4"></circle>
                        <path d="M20 8v6"></path>
                        <path d="M23 11h-6"></path>
                    </svg>
                </div>
            </div>
            <p class="stat-value">{{ stats.active_enrollments }}</p>
        </a>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px;">
        <div>
            <div class="section-header">
                <h2>Recent Users</h2>
                <a href="/admin/users" class="btn-primary">View All</a>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Created</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in recent_users %}
                        <tr class="clickable-row" onclick="window.location.href='/admin/users/{{ user.id }}/edit'">
                            <td>{{ user.username }}</td>
                            <td>{{ user.email }}</td>
                            <td><span class="badge badge-info">{{ user.role }}</span></td>
                            <td>{{ user.created_at.strftime('%Y-%m-%d') }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div>
            <div class="section-header">
                <h2>Recent Courses</h2>
                <a href="/admin/courses" class="btn-primary">View All</a>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Course Code</th>
                            <th>Course Name</th>
                            <th>Status</th>
                            <th>Created</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for course in recent_courses %}
                        <tr class="clickable-row" onclick="window.location.href='/admin/courses/{{ course.id }}/edit'">
                            <td>{{ course.code }}</td>
                            <td>{{ course.name }}</td>
                            <td>
                                {% if course.is_active %}
                                <span class="badge badge-success">Active</span>
                                {% else %}
                                <span class="badge badge-warning">Inactive</span>
                                {% endif %}
                            </td>
                            <td>{{ course.created_at.strftime('%Y-%m-%d') }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
